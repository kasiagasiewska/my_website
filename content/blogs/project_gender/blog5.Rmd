---
title: "Session 6: Homework 3"
author: "
date: "`r Sys.Date()`"
output:
  html_document:
    theme: flatly
    highlight: zenburn
    number_sections: yes
    toc: yes
    toc_float: yes
    code_folding: show
---


```{r, setup, echo=FALSE}
knitr::opts_chunk$set(
  message = FALSE, 
  warning = FALSE, 
  tidy=FALSE,     # display code as typed
  size="small")   # slightly smaller font for code
options(digits = 3)

# default figure size
knitr::opts_chunk$set(
  fig.width=6.75, 
  fig.height=6.75,
  fig.align = "center"
)
```


```{r load-libraries, echo=FALSE}
library(tidyverse)  # Load ggplot2, dplyr, and all the other tidyverse packages
library(mosaic)
library(ggthemes)
library(GGally)
library(readxl)
library(here)
library(skimr)
library(janitor)
library(broom)
library(tidyquant)
library(infer)
library(openintro)
library(kableExtra)
```


# Youth Risk Behavior Surveillance

Every two years, the Centers for Disease Control and Prevention conduct the [Youth Risk Behavior Surveillance System (YRBSS)](https://www.cdc.gov/healthyyouth/data/yrbs/index.htm) survey, where it takes data from high schoolers (9th through 12th grade), to analyze health patterns. You will work with a selected group of variables from a random sample of observations during one of the years the YRBSS was conducted.

## Load the data

```{r}
data(yrbss)
glimpse(yrbss)
```


## Exploratory Data Analysis

```{r, eda_on_weight}
skim(yrbss)
```

```{r}

#a new variable `physical_3plus`, which will be `yes` if they are physically active for at least 3 days a week, and `no` otherwise
yrbss1 <- yrbss %>% 
  mutate(physical_3plus = ifelse(physically_active_7d >= 3, "yes", "no"))

#count the number of no's and yes's and the probability of each one
yrbss_summary <- yrbss1 %>%
  filter(!is.na(physical_3plus)) %>%
  group_by(physical_3plus) %>% 
  summarise(count = n()) %>% 
  mutate(prop= count/sum(count))

```

```{r, boxplot}
#sum population
count_pop <- yrbss_summary  %>%  
  summarise(sum = sum(count))
#calculating the SE
se_pop <- sqrt(yrbss_summary$prop[1] * (1-yrbss_summary$prop[1])/count_pop)
#calculating the mean
mean_pop <- se_pop/sqrt(count_pop)
#t-critical value, 95% con
t_critical <- qt(c(0.025, 0.975), df=count_pop$sum-1)
lower_ci <- mean_pop - t_critical * se_pop
upper_ci <- mean_pop + t_critical * se_pop

yrbss_clean <- na.omit(yrbss1)
bp_physical_3plus <- yrbss_clean %>% 
  ggplot(aes(x = physical_3plus,y = weight)) + 
  geom_boxplot() + 
  labs( x = "Do the students excerise more than 3 times a week?", y= "Student weight", title = "Surprisingly, students who excerise often weigh more on average!") + 
  coord_flip() + 
  theme_bw()

bp_physical_3plus

```


## Confidence Interval

```{r}
yrbss_confidence_interval <- yrbss1 %>%
  group_by(physical_3plus) %>%
  filter(!is.na(physical_3plus)) %>% 
  summarise(mean_weight = mean(weight, na.rm = TRUE), #na.rm = TRUE removes all the NA values
            sd_weight = sd(weight, na.rm=TRUE),
            count = n(),
            se_weight = sd_weight/sqrt(count),
            t_critical = qt(c(0.025, 0.975), df=count_pop$sum-1), 
            margin_of_error = t_critical * se_weight,
            lower = mean_weight - margin_of_error,
            upper = mean_weight + margin_of_error
            )

yrbss_confidence_interval %>%
  kbl(col.names = c("Does student exercise 3 times a week or not?", "Mean Weight", "Stand Deviation of Weight", "Count", "Standard Error of Weight","T value", "Margin of Error", "Lower CI", "Upper CI")) %>%
  kable_material(c("striped", "hover")) %>%
  kable_styling(fixed_thead = T, full_width = FALSE) 
```
> There is an observed difference of about 1.77kg (68.4 - 66.7), and we notice that the two confidence intervals do not overlap. It seems that the difference is at least 95% statistically significant.


## Hypothesis test with formula

Write the null and alternative hypotheses for testing whether mean weights are different for those who exercise at least times a week and those who don’t.

```{r}

#The null and alternative hypothesis for testing whether mean weights are different for those who exercise at least three times a week and those who don't

t.test(weight ~ physical_3plus, data = yrbss1)
```

## Hypothesis test with `infer`

Next, we will introduce a new function, `hypothesize`, that falls into the infer workflow. You will use this method for conducting hypothesis tests.

But first, we need to initialize the test, which we will save as `obs_diff`.

```{r}
obs_diff <- yrbss1 %>%
  specify(weight ~ physical_3plus) %>%
  calculate(stat = "diff in means", order = c("yes", "no"))

```

```{r}
null_dist <- yrbss1 %>%
  specify(weight ~ physical_3plus) %>%
  hypothesize(null = "independence") %>%
  generate(reps = 1000, type = "permute") %>% #permute to quantify the null distribution
  calculate(stat = "diff in means", order = c("yes", "no"))

```

```{r}
ggplot(data = null_dist, aes(x = stat)) +
  geom_histogram() +labs(x= "Difference between two population means (weight & frequency of exercise (>3 times per week))", title = "Null hypothesis as a test for independence between weight and frequency of exercise demonstrates a normal distribution") +theme_bw()
```
> A visualisation of the null distribution shows a normal distribution. 


```{r}

null_dist %>% visualize() +
  shade_p_value(obs_stat = obs_diff, direction = "two-sided") + theme_bw()

null_dist %>%
  get_p_value(obs_stat = obs_diff, direction = "two_sided")

```
> With an approximate p-value of 0, we would be rejecting the null hypothesis. This implies that there is a difference between the two population means, ie weight of student and the frequency of physical exercise. 


# IMDB ratings: Differences between directors

Recall the IMBD ratings data. I would like you to explore whether the mean IMDB rating for Steven Spielberg and Tim Burton are the same or not. I have already calculated the confidence intervals for the mean ratings of these two directors and as you can see they overlap. 

```{r directors, out.width="100%"}
knitr::include_graphics(here::here("images", "directors.png"), error = FALSE)
```

## Confidence intervals for the mean ratings of these two directors

```{r load-movies-data}
movies <- read_csv(here::here("data", "movies.csv"))
glimpse(movies)
```

```{r, fig.width=10, fig.height=6}
selected_directors <- movies %>%
  select(director, rating) %>%
  filter(director == "Steven Spielberg" | director == "Tim Burton") %>%
  group_by(director) %>%
  summarize(avg = mean(rating), 
            sd = sd(rating), 
            count = n(),
            tstat = qt(0.975, count-1),
            se = sd/sqrt(count),
            
            lower_ci = avg - tstat*se, 
            upper_ci = avg + tstat*se) 
selected_directors

ggplot(selected_directors, aes(x = avg, y = reorder(director, avg), color = director)) +
  geom_errorbar(aes(xmin = lower_ci, xmax = upper_ci), width = 0.1) +
  labs(title = "Do Spielberg and Burton have the same IMDB Ratings",
       subtitle = "95% confidence intervals overlap",
       x = "Mean IMDB Rating", y = "") +
  geom_text(aes(label=round(lower_ci,2)), vjust=-1.5,hjust=3,angle=0, color="black", size=8) +
  geom_text(aes(label=round(upper_ci,2)), vjust=-1.5,hjust=-2,angle=0, color="black", size=8) +
  geom_text(aes(label=round(avg,2)), vjust=-2, colour= "black", size= 15)+
  geom_point() +
  theme(legend.position = "none") +
  annotate("rect", fill = "grey", alpha = 0.5, xmin=7.27, xmax= 7.33, ymin=-Inf, ymax = Inf)

```


## Hypothesis test

> The null hypothesis: Mean IMDB Ratings for Steven Spielberg and Tim Burton are the same
The alternative hypothesis: Mean IMDB Ratings for Steven Spielberg and Tim Burton are 
*NOT* the same

```{r}
Testing_null <- movies %>%
  select(director, rating) %>%
  filter(director == "Steven Spielberg" | director == "Tim Burton")

t.test(rating ~ director, data =Testing_null)
```

> According to the p-value found (p-value = 0.01) which is less than 0.05, hence we reject the null hypothesis. Therefore assume that the average IMDB Ratings for Steven Spielberg and Tim Burton are not the same.

```{r}
#Initialize the test
init_rating_null<- Testing_null%>%
specify(rating ~ director)%>%
  
calculate(stat="diff in means",order=c("Steven Spielberg","Tim Burton")) 

#Simulate the test on the null distribution, which we will save as null
ratings_null_world<-Testing_null%>%
specify(rating ~ director)%>%
hypothesize(null="independence")%>%
generate(reps=1000,type="permute")%>%
  
calculate(stat="diff in means",order=c("Steven Spielberg","Tim Burton"))

#Visualize the null distribution and get the p value
ratings_null_world %>% 
visualize() +
  shade_p_value(obs_stat = init_rating_null, direction = "two-sided") 
ratings_null_world %>% get_p_value(obs_stat = init_rating_null, direction = "two_sided")
```

> According to the p-value found (p-value = 0.008) which is less than 0.05, hence we reject the null hypothesis. Therefore assume that the average IMDB Ratings for Steven Spielberg and Tim Burton are not the same.




# Omega Group plc- Pay Discrimination

At the last board meeting of Omega Group Plc., the headquarters of a large multinational company, the issue was raised that women were being discriminated in the company, in the sense that the salaries were not the same for male and female executives. A quick analysis of a sample of 50 employees (of which 24 men and 26 women) revealed that the average salary for men was about 8,700 higher than for women. This seemed like a considerable difference, so it was decided that a further analysis of the company salaries should be conducted. 

Our team carried out the analysis to find out whether there is indeed a significant difference between the salaries of men and women, and whether the difference is due to discrimination or whether it is based on another, possibly valid, determining factor. 

```{r load_omega_data}
omega <- read_csv(here::here("data", "omega.csv"))
glimpse(omega) # examine the data frame
```


## Is there a significant difference between the salaries of the male and female executives?

```{r, confint_single_valiables}
# Summary Statistics of salary by gender
mosaic::favstats (salary ~ gender, data=omega)

# Dataframe with two rows (male-female) and having as columns gender, mean, SD, sample size, 
# the t-critical value, the standard error, the margin of error, 
# and the low/high endpoints of a 95% confidence interval
statistics<-omega%>%
select(salary,gender)%>%
  group_by(gender)%>%
  summarise(mean=mean(salary),SD=sd(salary),SampleSize=n(),t_crit=qt(0.975,SampleSize-1),SE=SD/sqrt(SampleSize),
            MarginError=t_crit*SE,LowBound=mean-MarginError,HighBound=mean+MarginError)
statistics

```

> From the data obtained, we can observe that the confidence intervals do not overlap. Hence, we can conclude that there is a significant difference between the salaries of male and female executives. 


```{r, hypothesis_testing_salary_gender}
# Hypothesis testing using t.test() 
t.test(salary ~ gender, data = omega)

# Hypothesis testing using infer package

#Initialize the test
init_sal_null<-omega%>%
specify(salary ~ gender)%>%
calculate(stat="diff in means",order=c("female","male")) 
#Simulate the test on the null distribution, which we will save as null
salaries_null_world<-omega%>%
  specify(salary ~ gender)%>%
  hypothesize(null="independence")%>%
  generate(reps=1000,type="permute")%>%
  calculate(stat="diff in means",order=c("female","male"))
#Visualize the null distribution and get the p value
salaries_null_world %>% visualize() +
  shade_p_value(obs_stat = init_sal_null, direction = "two-sided")+
  #Customize the plot
  labs(x="Difference between mean salary of women and men",y="Count",title="Is there a significant difference between men and women's salaries?",subtitle="Null hypothesis distribution and p-value")+theme_clean()
#Get the numerical value for p
salaries_null_world %>% get_p_value(obs_stat = init_sal_null, direction = "two_sided")
```

> From the hypothesis testing, we are more than 95% confident that the null hypothesis is untrue. A significant difference between the male and female executive salaries has been confirmed in 3 different ways: the hypothesis testing using t.test(), the plot of the null hypothesis distribution with a red line corresponding to the p-threshold (as we can visually observe the line is very far away from 0), and a p<0.05. However, we cannot affirm that this significant difference is due to discrimination as there may be some other factors involved. Finding out the true causes of the salary gap requires further analyses.



## Is there a significant difference between the experience of the male and female executives?

```{r, experience_stats}
# Summary Statistics of experience by gender
favstats (experience ~ gender, data=omega)
#Calculate additional key statistics and confidence intervals
statistics<-omega%>%
select(experience,gender)%>%
  group_by(gender)%>%
  summarise(mean=mean(experience),SD=sd(experience),SampleSize=n(),t_crit=qt(0.975,SampleSize-1),SE=SD/sqrt(SampleSize),
  MarginError=t_crit*SE,LowBound=mean-MarginError,HighBound=mean+MarginError)
statistics
```

> The 95% confidence intervals do not overlap. Hence, we can conclude that there is a significant difference in the experience of female and male executives.
Further tests based on null hypothesis are conducted below.  


```{r, hypothesis_testing_experience}
# Hypothesis testing using t.test() 
t.test(experience ~ gender, data = omega)

# Hypothesis testing using infer package
#Initialize the test
init_exp_null <- omega %>%
specify(experience ~ gender)%>%
calculate(stat="diff in means",order=c("female","male")) 

#Simulate the test on the null distribution, which we will save as experience_null_world
experience_null_world <- omega %>%
  specify(experience ~ gender) %>%
  hypothesize(null="independence") %>%
  generate(reps=1000,type="permute") %>%
  calculate(stat="diff in means",order=c("male","female"))

#Visualize the null distribution and get the p value
experience_null_world %>% visualize() +
  shade_p_value(obs_stat = init_exp_null, direction = "two-sided")+
  #Customize the plot
  labs(x="Difference between mean experience of women and men",y="Count",title="Is there a significant difference between men and women's experience?",subtitle="Null hypothesis distribution and p-value")+theme_clean()
#Get the numerical p value
experience_null_world %>% get_p_value(obs_stat = init_exp_null, direction = "two_sided")
```

> From the data obtained using t.test(), the plot of the null distribution and the p value (which is less than 0.05), we can reject the null hypothesis. Hence, we can conclude that there is a significant difference between the experience of men and women. This conclusion doesn't endanger the previous one that indicated that salaries of men and women are significantly different. However, from the current analysis, we can say the salaries are not necessarily different due to factors such as gender discrimination, there can be other factors such as experience having an important effect on the salary gap.


## The relationship between salary and experience

```{r, salary_exp_scatter}

ggplot(omega,aes(x=experience,y=salary)) + geom_smooth() + theme_clean() + geom_point() + labs(title="Relationship between experience and salary ",x="Experience",y="Salary")

```

## Check correlations between the data

We will generate a matrix in order to better visualize relationships between salary, experience and gender before reaching a conclusion.
```{r, ggpairs}
omega %>% 
  select(gender, experience, salary) %>% #order variables they will appear in ggpairs()
  ggpairs(aes(colour=gender, alpha = 0.3))+
  theme_bw()
```

>The scatterplot displaying the relationship between salary and experience shows us that these two variables are positively correlated. Moreover, their relationship resemble a logarithmic function, meaning that the marginal effect of a year of experience is positive but decreases over time.

>Our previous hypothesis testing and the correlation matrix confirm that males have on average more experience and higher salaries than females at Omega. Moreover,the correlation between salary and experience is positive and significant for both genders (ρ females= 0.812, ρ males= 0.661, ρ both=0.803), validating that the salary gap between the two groups may not come from discrimination but mainly from the difference in experience.

>Note that the slight discrepancy in the correlation between salary and experience across genders is caused by the cluster at experience=0 : many females at Omega have no experience and start at different salaries, perhaps because they have different degrees or backgrounds. Since we have no data points for males at experience=0 , it generates a difference between ρ females and  ρ males. It would have been interestin tog analyze further if the same would have happened to males with no experience.


# Challenge 1: Brexit plot

In the following section we recreate the plot showing how the political affiliation in the 2015 UK general election translated into Brexit Voting. 

```{r load_brexit_data, warning=FALSE, message=FALSE, echo = FALSE}
brexit_results <- read_csv(here::here("Data","brexit_results.csv"))

```

```{r brexit_challenge_1, fig.width=10}

brexit_results_adjusted <- brexit_results %>% 
  # creating an additional column that indicates the percentage of people that didn't vote: will not be used for this particular exercise
  mutate(no_vote = 100-con_2015-lab_2015-ld_2015-ukip_2015) %>% 
  # using pivot longer to create a column with the party affiliation as well as the respective percentage of votes
  pivot_longer(cols = c(con_2015:ukip_2015),
               names_to = "Party_vote",
               values_to = "Vote_share") %>% 
  # renaming the values to be more descriptive
  mutate(Party_vote = case_when(
    Party_vote == "con_2015" ~ "Conservative",
    Party_vote == "lab_2015" ~ "Labour",
    Party_vote == "ld_2015" ~ "Lib Dems", 
    Party_vote == "ukip_2015" ~ "UKIP" 
  )) 

#brexit_results_adjusted

ggplot(brexit_results_adjusted,  aes(x = Vote_share, y = leave_share, colour = Party_vote)) +
  geom_point(alpha=0.35) +
  scale_y_continuous(limits = c(20,100)) +
  scale_colour_manual(values = c("#0087dc", "#d50000", "#FDBB30", "#EFE600")) +
  geom_smooth(method = "lm") +
  labs(title = "How political affiliation translated to Brexit Voting", x = "Party % in the UK 2015 general election", y = "Leave % in the 2016 Brexit referendum") +
  theme(panel.grid.major = element_line(colour = "#f0f0f0"),
        panel.background = element_rect(colour = "black", size=0.5, fill = NA),
        legend.key = element_rect(colour = "transparent", fill = "transparent"),
        legend.position = "bottom",
        legend.title = element_blank())

```


# Challenge 2:GDP components over time and among countries

```{r read_GDP_data}

UN_GDP_data  <-  read_excel(here::here("data", "Download-GDPconstant-USD-countries.xls"), # Excel filename
                sheet="Download-GDPconstant-USD-countr", # Sheet name
                skip=2) # Number of rows to skip
# glimpse(UN_GDP_data)

```


```{r reshape_GDP_data}

tidy_GDP_data <- UN_GDP_data %>%
  pivot_longer(cols = `1970`:`2017`, names_to = "Year", values_to = "Value") %>%
  mutate(Value = Value/1e9, IndicatorName = case_when(
    IndicatorName == "Final consumption expenditure" ~ "Final_Exp",
    IndicatorName == "Household consumption expenditure (including Non-profit institutions serving households)" ~ "Household_Exp",
    IndicatorName == "General government final consumption expenditure" ~ "Govt_Exp",
    IndicatorName == "Gross capital formation" ~ "GCF",
    IndicatorName == "Gross fixed capital formation (including Acquisitions less disposals of valuables)" ~ "GFCF",
    IndicatorName == "Exports of goods and services" ~ "Exports",
    IndicatorName == "Imports of goods and services" ~ "Imports",
    IndicatorName == "Agriculture, hunting, forestry, fishing (ISIC A-B)" ~ "ISIC A-B",
    IndicatorName == "Mining, Manufacturing, Utilities (ISIC C-E)" ~ "ISIC C-E",
    IndicatorName == "Manufacturing (ISIC D)" ~ "ISIC D",
    IndicatorName == "Construction (ISIC F)" ~ "ISIC F",
    IndicatorName == "Wholesale, retail trade, restaurants and hotels (ISIC G-H)" ~ "Retail/Tourism",
    IndicatorName == "Transport, storage and communication (ISIC I)" ~ "ISIC I",
    IndicatorName == "Other Activities (ISIC J-P)" ~ "ISIC J-P",
    IndicatorName == "Total Value Added" ~ "Total Value",
    IndicatorName == "Gross Domestic Product (GDP)" ~ "GDP"
  ))


# Let us compare GDP components for these 3 countries
country_list <- c("United States","India", "Germany")
```


## Our reproduction 1: GDP Components over time

```{r gdp1, echo=FALSE, out.width="100%"}
knitr::include_graphics(here::here("images", "gdp1.png"), error = FALSE)
```

```{r GDP_graphs, fig.width = 10}
indicator_list = c("GCF", "Exports", "Govt_Exp", "Household_Exp", "Imports")
selected <- tidy_GDP_data %>%
  filter(Country %in% country_list & IndicatorName %in% indicator_list) %>%
  group_by(Country, IndicatorName, Year)

selected$IndicatorName <- factor(selected$IndicatorName, 
                                 levels = c("GCF", 
                                            "Exports", 
                                            "Govt_Exp", 
                                            "Household_Exp",
                                            "Imports"))

ggplot(selected, aes(x = Year, y = Value, group = IndicatorName, color = IndicatorName)) +
  geom_line(size = 1) +
  labs(title = "GDP Components over time", 
       subtitle = "In constant 2010 USD", 
       y = "Billions US$", 
       color = "Components of GDP") +
  facet_wrap(~Country) +
  scale_x_discrete(breaks = scales::pretty_breaks(5)) +
  scale_color_discrete(labels = c("Gross capital formation", 
                                 "Exports", 
                                 "Government expenditure",
                                 "Household expenditure",
                                 "Imports")) +
  theme(panel.grid = element_line(colour = "#f0f0f0"),
        strip.background = element_rect(colour = "black", size = 0.5, fill = "grey80"),
        panel.background = element_rect(colour = "black", size=0.5, fill = NA),
        legend.key = element_rect(colour = "transparent", fill = "transparent"),
        axis.title.x = element_blank())
```


## Calculation of Components of GDP 

```{r}
selected_GDP <- selected %>%
  mutate(Value = case_when(
    IndicatorName == "Imports" ~ -Value,
    TRUE ~ Value
  )) %>%
  group_by(Year, Country) %>%
  summarize(calc_GDP = sum(Value)) %>%
  # filter(Country == "Germany", Year == "1970")
  
  inner_join(tidy_GDP_data %>% filter(IndicatorName == "GDP"), by = c("Country", "Year")) %>%
  mutate(pct_diff = (calc_GDP/Value - 1)*100)

selected_GDP %>%
  select(Year, Country, calc_GDP, Value, pct_diff) %>%
  group_by(Country, Year) %>%
  kbl(col.names = c("Year", "Country", "Calculated GDP", "Given GDP", "Difference (%)")) %>%
  kable_material(c("striped", "hover")) %>%
  kable_styling(fixed_thead = T)


```


## Our reproduction 2: GDP and its breakdown at constant 2010 prices in US Dollars

```{r gdp2, echo=FALSE, out.width="100%"}
knitr::include_graphics(here::here("images", "gdp2.png"), error = FALSE)
```



What is this last chart telling you? Can you explain in a couple of paragraphs the different dynamic among these three countries? 

>In this chart we can see Germany's economy has adapted over time to become a net positive exporter, beginning to increase exports around 1999. This coincides with their introduction into the Eurozone, which enabled them to trade their products more freely. 

>In India, we can see the dramatic increase in GCF as a proportion of GDP, which is due to large scale investment happening throughout the 2000s. Because increased investment also drove the quickly growing GDP it simulateously shrunk the proportion of GDP Household expenditures was responsible for.

>The United States has a very developed economy and thus the shift in GDP Components is less dramatic. The main things we can see are Government Expenditure and Net Exports falling proportionally as both GCF and Household Expenditures become a larger proportion. The fall of Exports can be attributed to the US transitioning to a service based economy and moving manufacturing to other countries.



```{r, fig.height = 6, fig.width= 10}
prop_GDP <- selected %>%
  filter(IndicatorName != "GDP") %>%
  pivot_wider(names_from = IndicatorName, values_from = Value) %>%
  mutate(Net_Exports = Exports - Imports) %>%
  select(Country:GCF, Net_Exports) %>%
  pivot_longer(cols = Household_Exp:Net_Exports,
               names_to = "Components", 
               values_to = "Value") %>%
  group_by(Country, Year) %>%
  mutate(Value = Value/sum(Value))

ggplot(prop_GDP, aes(x = Year, y = Value, group = Components, color = Components)) +
  geom_line(size = 1) +
  labs(title = "GDP and its breakdown at constant 2010 prices in US Dollars", 
       y = "proportion", caption = "Source: United Nations,https://unstats.un.org/unsd/snaama/Downloads") +
  facet_wrap(~Country) +
  scale_x_discrete(breaks = scales::pretty_breaks(5)) +
  scale_y_continuous(labels = scales ::percent) +
  scale_color_discrete(labels = c("Gross capital formation", 
                                 "Government expenditure",
                                 "Household expenditure",
                                 "Net Exports")) +
  theme(panel.grid = element_line(colour = "#f0f0f0"),
        strip.background = element_rect(colour = "black", size = 0.5, fill = "grey80"),
        panel.background = element_rect(colour = "black", size=0.5, fill = NA),
        legend.key = element_rect(colour = "transparent", fill = "transparent"),
        axis.title.x = element_blank(),
        plot.caption = element_text(hjust = 1,size = 8))
```
